{"version":3,"sources":["../../../src/handlers/oauth/login.js"],"names":["login","username","password","user","models","users","getCredentialsInfo","helpers","verify","roleDetails","getRoleInfo","role","id","jwt","sign","JSON","stringify"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEO,MAAMA,KAAK,GAAG,OAAO;AAAEC,EAAAA,QAAF;AAAYC,EAAAA;AAAZ,CAAP,KAAkC;AACrD,QAAMC,IAAI,GAAG,MAAMC,MAAM,CAACC,KAAP,CAAaC,kBAAb,CAAgCL,QAAhC,CAAnB;AACA,QAAMM,OAAO,CAACL,QAAR,CAAiBM,MAAjB,CAAwBN,QAAxB,EAAkCC,IAAI,CAACD,QAAvC,CAAN;AACA,SAAOC,IAAI,CAACD,QAAZ;AAEA,QAAMO,WAAW,GAAG,MAAML,MAAM,CAACC,KAAP,CAAaK,WAAb,CAAyBP,IAAI,CAACQ,IAA9B,EAAoCR,IAAI,CAACS,EAAzC,CAA1B;AACA,SAAOL,OAAO,CAACM,GAAR,CAAYC,IAAZ,CAAiBC,IAAI,CAACC,SAAL,CAAe,EAAE,GAAGb,IAAL;AAAW,OAAGM;AAAd,GAAf,CAAjB,CAAP;AACD,CAPM","sourcesContent":["import * as models from \"~/models\";\nimport * as helpers from \"~/helpers\";\n\nexport const login = async ({ username, password }) => {\n  const user = await models.users.getCredentialsInfo(username);\n  await helpers.password.verify(password, user.password);\n  delete user.password;\n\n  const roleDetails = await models.users.getRoleInfo(user.role, user.id);\n  return helpers.jwt.sign(JSON.stringify({ ...user, ...roleDetails }));\n};\n"],"file":"login.js"}