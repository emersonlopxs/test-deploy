{"version":3,"sources":["../../../src/handlers/user/reset-password.js"],"names":["sendGridMail","setApiKey","SENDGRID_KEY","sendMail","email","password","send","from","SENDGRID_FROM","html","subject","SENDGRID_SUBJECT_RESET_PASSWORD","text","to","resetPassword","randomPassword","Math","random","toString","slice","encryptedPassword","helpers","hash","models","users","updatePassword"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEAA,cAAaC,SAAb,CAAuBC,oBAAvB;;AAEA,MAAMC,QAAQ,GAAG,CAACC,KAAD,EAAQC,QAAR,KACfL,cAAaM,IAAb,CAAkB;AAChBC,EAAAA,IAAI,EAAEC,qBADU;AAEhBC,EAAAA,IAAI,EAAG,+EAA8EJ,QAAS,KAF9E;AAGhBK,EAAAA,OAAO,EAAEC,uCAHO;AAIhBC,EAAAA,IAAI,EAAG,4EAA2EP,QAAS,EAJ3E;AAKhBQ,EAAAA,EAAE,EAAET;AALY,CAAlB,CADF;;AASO,MAAMU,aAAa,GAAG,OAAO;AAAEV,EAAAA;AAAF,CAAP,KAAqB;AAChD,QAAMW,cAAc,GAAGC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,KAA3B,CAAiC,CAAC,CAAlC,CAAvB;AACA,QAAMC,iBAAiB,GAAG,MAAMC,OAAO,CAAChB,QAAR,CAAiBiB,IAAjB,CAAsBP,cAAtB,CAAhC;AACA,QAAMQ,MAAM,CAACC,KAAP,CAAaC,cAAb,CAA4BrB,KAA5B,EAAmCgB,iBAAnC,CAAN;AACA,QAAMjB,QAAQ,CAACC,KAAD,EAAQW,cAAR,CAAd;AACA,SAAO,EAAP;AACD,CANM","sourcesContent":["import sendGridMail from \"@sendgrid/mail\";\nimport * as models from \"~/models\";\nimport * as helpers from \"~/helpers\";\nimport { SENDGRID_SUBJECT_RESET_PASSWORD, SENDGRID_FROM, SENDGRID_KEY } from \"~/core/config\";\n\nsendGridMail.setApiKey(SENDGRID_KEY);\n\nconst sendMail = (email, password) =>\n  sendGridMail.send({\n    from: SENDGRID_FROM,\n    html: `Aqui está a sua nova senha para acessar o aplicativo da gerando falcões: <b>${password}<b>`,\n    subject: SENDGRID_SUBJECT_RESET_PASSWORD,\n    text: `Aqui está a sua nova senha para acessar o aplicativo da gerando falcões: ${password}`,\n    to: email,\n  });\n\nexport const resetPassword = async ({ email }) => {\n  const randomPassword = Math.random().toString(36).slice(-8);\n  const encryptedPassword = await helpers.password.hash(randomPassword);\n  await models.users.updatePassword(email, encryptedPassword);\n  await sendMail(email, randomPassword);\n  return {};\n};\n"],"file":"reset-password.js"}