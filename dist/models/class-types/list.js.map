{"version":3,"sources":["../../../src/models/class-types/list.js"],"names":["list","query","classTypeIds","limit","offset","rows","join","count","total","filters"],"mappings":";;;;;;;AAAA;;AAEO,MAAMA,IAAI,GAAG,OAAO;AAAEC,EAAAA,KAAF;AAASC,EAAAA,YAAT;AAAuBC,EAAAA,KAAK,GAAG,EAA/B;AAAmCC,EAAAA,MAAM,GAAG;AAA5C,CAAP,KAA2D;AAC7E,QAAMC,IAAI,GAAG,MAAM,sBAChB;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMJ,KAAK,GAAI,iBAAgB,oBAAKA,KAAL,CAAY,EAAhC,GAAoC,EAAG;AAClD,MAAMC,YAAY,GAAI,cAAaA,YAAY,CAACI,IAAb,EAAoB,GAArC,GAA0C,EAAG;AAC/D;AACA,KAZqB,EAajB,CAACH,KAAD,EAAQC,MAAR,CAbiB,CAAnB;AAgBA,QAAM;AAAEG,IAAAA,KAAK,EAAEC;AAAT,MAAmB,MAAM,qBAC5B;AACL;AACA;AACA;AACA;AACA,MAAMP,KAAK,GAAI,iBAAgB,oBAAKA,KAAL,CAAY,EAAhC,GAAoC,EAAG;AAClD,MAAMC,YAAY,GAAI,cAAaA,YAAY,CAACI,IAAb,EAAoB,GAArC,GAA0C,EAAG;AAC/D,KARiC,CAA/B;AAWA,SAAO;AAAEH,IAAAA,KAAF;AAASC,IAAAA,MAAT;AAAiBK,IAAAA,OAAO,EAAE;AAAER,MAAAA,KAAF;AAASC,MAAAA;AAAT,KAA1B;AAAmDM,IAAAA,KAAnD;AAA0DH,IAAAA;AAA1D,GAAP;AACD,CA7BM","sourcesContent":["import { first, select, like } from \"~/core/database\";\n\nexport const list = async ({ query, classTypeIds, limit = 10, offset = 0 }) => {\n  const rows = await select(\n    `\n    select\n      id,\n      name,\n      color,\n      description\n    from classTypes\n    where 1 = 1\n    ${query ? `and name like ${like(query)}` : \"\"}\n    ${classTypeIds ? `AND id in (${classTypeIds.join()})` : \"\"}\n    limit ? offset ?\n    `,\n    [limit, offset]\n  );\n\n  const { count: total } = await first(\n    `\n    select\n      count(*) as count\n    from classTypes\n    where 1 = 1\n    ${query ? `and name like ${like(query)}` : \"\"}\n    ${classTypeIds ? `AND id in (${classTypeIds.join()})` : \"\"}\n    `\n  );\n\n  return { limit, offset, filters: { query, classTypeIds }, total, rows };\n};\n"],"file":"list.js"}